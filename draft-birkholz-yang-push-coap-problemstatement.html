<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>YANG Push Operations for CoMI</title>

  
<style type="text/css">/*<![CDATA[*/
@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}

@media screen and (min-width: 1024px) {
  ul.toc, #rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 525px);
    width: 300px;
    z-index: 1;
  }
  #rfc\.toc {
    top: 15px;
  }
  ul.toc {
    top: 80px;
    overflow: auto;
  }

  body {
    padding-right: 350px;
  }
}

body {
  font: 15px "Helvetica Neue",Helvetica,Arial,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 130%;
  margin: 25px auto;
  max-width: 724px;
}

.title, .filename, h1, h2, h3, h4 {
  font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
  font-size-adjust: 0.5;
  font-weight: 500;
  color: #333;
  line-height: 100%;
  margin: 0.8em 0 0.3em;
}
.title { font-size: 36px; }
h1 { font-size: 30px; }
h2 { font-size: 24px; }
h3, h4 { font-size: 18px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

ul.toc li {
  list-style: none;
  text-indent: -2.5em;
  padding-left: 2.5em;
  padding-bottom: 5px;
  margin: 0;
}
ul.toc ul {
  margin: 0;
}
/* xml2rfc nests ul directly inside ul which messes with the style badly */
ul.toc, ul.toc>ul, ul.toc ul>ul {
  margin: 0 0 0 1.5em;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header {
  width: 100%;
}
table.header td {
  border: none;
  background-color: transparent;
  color: black;
}
.filename {
  color: rgb(119, 119, 119);
  font-size: 23px;
  font-weight: normal;
  height: auto;
  line-height: 100%;
}
#rfc\.abstract+p {
  font-size: 20px;
  font-weight: 300;
  line-height: 130%;
}

samp, tt, code, pre {
  font: 11pt consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure {
  font-style: italic;
  margin: 0 1.5em;
}

address {
  margin: 10px 0 0;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn {
  font-weight: bold;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

ol, ul, li, p {
  padding: 0;
  margin: 0.5em 0 0.5em 2em;
}
li, p {
  margin-left: 0;
}
address {
  font-style: normal;
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>


  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Context of the Problem">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Binary YANG transfer protocol">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Device-Type Scope">
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 Subscriptions via CoAP">
<link href="#rfc.section.1.4" rel="Chapter" title="1.4 Configured Subscriptions and Call-Home">
<link href="#rfc.section.1.5" rel="Chapter" title="1.5 Bootstrapping of Drop-Shipped Pledges">
<link href="#rfc.section.2" rel="Chapter" title="2 Summary of the Problem Statement">
<link href="#rfc.section.3" rel="Chapter" title="3 Potential Approaches and Solutions">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 YANG subscription variants">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 YANG Push via CoAP">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Dynamic Subscriptions">
<link href="#rfc.section.3.3.1" rel="Chapter" title="3.3.1 YANG Push via GET">
<link href="#rfc.section.3.3.2" rel="Chapter" title="3.3.2 YANG Push via FETCH">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Configured Subscriptions">
<link href="#rfc.section.3.4.1" rel="Chapter" title="3.4.1 Retaining the Content of a GET Operation as Configuration">
<link href="#rfc.section.3.4.2" rel="Chapter" title="3.4.2 Call Home via CoAP">
<link href="#rfc.section.3.4.3" rel="Chapter" title="3.4.3 Dynamic Home Discovery">
<link href="#rfc.section.4" rel="Chapter" title="4 IANA considerations">
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 Acknowledgements">
<link href="#rfc.section.7" rel="Chapter" title="7 Change Log">
<link href="#rfc.references" rel="Chapter" title="8 Normative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.8.2 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Birkholz, H., Zhou, T., Liu, X., and E. Voit" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-birkholz-yang-push-coap-problemstatement-latest" />
  <meta name="dct.issued" scheme="ISO8601" content="2017-10-18" />
  <meta name="dct.abstract" content="This document provides a problem statement, derives an initial gap analysis and illustrates a first set of solution approaches in regard to augmenting YANG data stores based on the CoAP Management Interface with YANG Push capabilities. A binary transfer mechanism for YANG Subscribed Notifications addresses both the requirements of constrained-node networks and the need for semantic interoperability via self-descriptiveness of the corresponding data in motion." />
  <meta name="description" content="This document provides a problem statement, derives an initial gap analysis and illustrates a first set of solution approaches in regard to augmenting YANG data stores based on the CoAP Management Interface with YANG Push capabilities. A binary transfer mechanism for YANG Subscribed Notifications addresses both the requirements of constrained-node networks and the need for semantic interoperability via self-descriptiveness of the corresponding data in motion." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">NETCONF Working Group</td>
<td class="right">H. Birkholz</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Fraunhofer SIT</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">T. Zhou</td>
</tr>
<tr>
<td class="left">Expires: April 21, 2018</td>
<td class="right">Huawei</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">X. Liu</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Jabil</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">E. Voit</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Cisco Systems</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 18, 2017</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">YANG Push Operations for CoMI<br />
  <span class="filename">draft-birkholz-yang-push-coap-problemstatement-latest</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document provides a problem statement, derives an initial gap analysis and illustrates a first set of solution approaches in regard to augmenting YANG data stores based on the CoAP Management Interface with YANG Push capabilities. A binary transfer mechanism for YANG Subscribed Notifications addresses both the requirements of constrained-node networks and the need for semantic interoperability via self-descriptiveness of the corresponding data in motion.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 21, 2018.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2017 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Context of the Problem</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Binary YANG transfer protocol</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Device-Type Scope</a>
</li>
<li>1.3.   <a href="#rfc.section.1.3">Subscriptions via CoAP</a>
</li>
<li>1.4.   <a href="#rfc.section.1.4">Configured Subscriptions and Call-Home</a>
</li>
<li>1.5.   <a href="#rfc.section.1.5">Bootstrapping of Drop-Shipped Pledges</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">Summary of the Problem Statement</a>
</li>
<li>3.   <a href="#rfc.section.3">Potential Approaches and Solutions</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">YANG subscription variants</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">YANG Push via CoAP</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Dynamic Subscriptions</a>
</li>
<ul><li>3.3.1.   <a href="#rfc.section.3.3.1">YANG Push via GET</a>
</li>
<li>3.3.2.   <a href="#rfc.section.3.3.2">YANG Push via FETCH</a>
</li>
</ul><li>3.4.   <a href="#rfc.section.3.4">Configured Subscriptions</a>
</li>
<ul><li>3.4.1.   <a href="#rfc.section.3.4.1">Retaining the Content of a GET Operation as Configuration</a>
</li>
<li>3.4.2.   <a href="#rfc.section.3.4.2">Call Home via CoAP</a>
</li>
<li>3.4.3.   <a href="#rfc.section.3.4.3">Dynamic Home Discovery</a>
</li>
</ul></ul><li>4.   <a href="#rfc.section.4">IANA considerations</a>
</li>
<li>5.   <a href="#rfc.section.5">Security Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">Acknowledgements</a>
</li>
<li>7.   <a href="#rfc.section.7">Change Log</a>
</li>
<li>8.   <a href="#rfc.references">Normative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#context-of-the-problem" id="context-of-the-problem">Context of the Problem</a>
</h1>
<p id="rfc.section.1.p.1">A binary transfer capability for YANG Subscribed Notifications <a href="#I-D.ietf-netconf-subscribed-notifications" class="xref">[I-D.ietf-netconf-subscribed-notifications]</a> based on YANG Push <a href="#I-D.ietf-netconf-yang-push" class="xref">[I-D.ietf-netconf-yang-push]</a> can be realized by using existing RFC and I-D work as building blocks. This section is intended to provide a corresponding overview of the existing ecosystem in order to identify gaps and therefore provide a problem statement.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#binary-yang-transfer-protocol" id="binary-yang-transfer-protocol">Binary YANG transfer protocol</a>
</h1>
<p id="rfc.section.1.1.p.1">The CoAP Management Interface I-D (CoMI <a href="#I-D.ietf-core-comi" class="xref">[I-D.ietf-core-comi]</a>) defines operations for a YANG data store based on the Constrained Application Protocol (CoAP <a href="#RFC7252" class="xref">[RFC7252]</a>).  CoAP uses a request/response interaction model that is based on HTTP (similar to RESTCONF <a href="#RFC8040" class="xref">[RFC8040]</a>) and allows for multiple transports, including UDP or TCP (see <a href="#I-D.ietf-core-coap-tcp-tls" class="xref">[I-D.ietf-core-coap-tcp-tls]</a>). The Concise Binary Object Representation (CBOR <a href="#RFC7049" class="xref">[RFC7049]</a>) is used for the serialization of data in motion in respect to CoAP operations and the data modeled with YANG <a href="#I-D.ietf-core-yang-cbor" class="xref">[I-D.ietf-core-yang-cbor]</a>.</p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> <a href="#device-type-scope" id="device-type-scope">Device-Type Scope</a>
</h1>
<p><a href="#I-D.ietf-core-comi" class="xref">[I-D.ietf-core-comi]</a> states that CoAP "is designed for Machine to Machine (M2M) applications such as smart energy, smart city and building control. Constrained devices need to be managed in an automatic fashion to handle the large quantities of devices that are expected in future installations. Messages between devices need to be as small and infrequent as possible. The implementation complexity and runtime resources need to be as small as possible."</p>
<p id="rfc.section.1.2.p.2">In addition, <a href="#I-D.ietf-core-comi" class="xref">[I-D.ietf-core-comi]</a> highlights that "CoMI and RESTCONF are intended to work in a stateless client-server fashion. They use a single round-trip to complete a single editing transaction, where NETCONF needs up to 10 round trips. To promote small messages, CoMI uses a YANG to CBOR mapping <a href="#I-D.ietf-core-yang-cbor" class="xref">[I-D.ietf-core-yang-cbor]</a> and numeric identifiers <a href="#I-D.ietf-core-sid" class="xref">[I-D.ietf-core-sid]</a> to minimize CBOR payloads and URI length."</p>
<p id="rfc.section.1.2.p.3">In essence, via CoMI, a small sensor can emit a set of measurements as binary encoded YANG notifications, which would only add a minimal overhead to the data in motion, but would increase interoperability significantly due to the powerful and widely used semantics enabled by YANG (in contrast to a set of raw values that always require additional context information and imperative guidance to be managed and post-processed appropriately).</p>
<h1 id="rfc.section.1.3">
<a href="#rfc.section.1.3">1.3.</a> <a href="#subscriptions-via-coap" id="subscriptions-via-coap">Subscriptions via CoAP</a>
</h1>
<p id="rfc.section.1.3.p.1">The CoAP pub/sub I-D defines a CoAP Subscribe operation <a href="#I-D.ietf-core-coap-pubsub" class="xref">[I-D.ietf-core-coap-pubsub]</a> that is based on observing resources via the Observe option for the GET operation as defined in <a href="#RFC7641" class="xref">[RFC7641]</a>. The CoAP pub/sub draft is intended to provide the capabilities and characteristics of MQTT via a CoAP based protocol. The only other CoAP operation that supports the Observe option is the FETCH operation defined in <a href="#RFC8132" class="xref">[RFC8132]</a>.</p>
<p id="rfc.section.1.3.p.2">The Observe option creates a small corresponding state on the server side that eliminates the need for continuous polling of a resource via subsequent requests. Instead, subsequent responses including both the Observe option and using the token of the request that initiated the observation are returned when the observed resource changes. A subscription (i.e. the observe state retained on the server) can be discarded by the client by sending a correspond CoAP GET with Observe using an Observe parameter of 1 or simply by "forgeting" the observation and return a CoAP Reset after receiving a notification in the context of the subscription. A subscription can also be discarded by the server by sending a corresponding response that does not contain an Observe option.</p>
<p id="rfc.section.1.3.p.3">The subscription used in CoAP pub/sub are used to subscribe to a topic provided by a CoAP broker REST API. YANG Push <a href="#I-D.ietf-netconf-yang-push" class="xref">[I-D.ietf-netconf-yang-push]</a> and corresponding YANG Subscribed Notifications are used to subscribe to data node updates provided by a YANG management interface. YANG subscriptions can include a filter expression (either a subtree expression or an XPATH expression). The encoding rules of XPATH expressions in CBOR are covered by <a href="#I-D.ietf-core-yang-cbor" class="xref">[I-D.ietf-core-yang-cbor]</a>.</p>
<h1 id="rfc.section.1.4">
<a href="#rfc.section.1.4">1.4.</a> <a href="#configured-subscriptions-and-call-home" id="configured-subscriptions-and-call-home">Configured Subscriptions and Call-Home</a>
</h1>
<p id="rfc.section.1.4.p.1">Configured subscriptions are basically static configuration that creates subscription state on the YANG data store when it is started and persists between boot-cycles without the need of a client to create that subscription state. In consequence, a configured subscription can result in unsolicited pushed notifications in respect to a YANG client.</p>
<p id="rfc.section.1.4.p.2">A popular variant of the configured subscription as defined in <a href="#I-D.ietf-netconf-yang-push" class="xref">[I-D.ietf-netconf-yang-push]</a> is the Call Home procedure defined in <a href="#RFC8071" class="xref">[RFC8071]</a>. In this approach, a Transport Layer application association with the YANG client is initiated by the YANG data store. After this "initial phase, in which the YANG server is acting like a client", the existing Transport Layer connection (or session, in case of, for example, TLS) is then used to the YANG client to initiate a subscription (i.e.  the YANG client is initiating a dynamic subscription based on a pre-configured request retained and issued by the YANG data store).</p>
<h1 id="rfc.section.1.5">
<a href="#rfc.section.1.5">1.5.</a> <a href="#bootstrapping-of-drop-shipped-pledges" id="bootstrapping-of-drop-shipped-pledges">Bootstrapping of Drop-Shipped Pledges</a>
</h1>
<p><a href="#I-D.ietf-anima-bootstrapping-keyinfra" class="xref">[I-D.ietf-anima-bootstrapping-keyinfra]</a> highlights that effectively "to literally 'pull yourself up by the bootstraps' is an impossible action. Similarly, the secure establishment of a key infrastructure without external help is also an impossibility."</p>
<p id="rfc.section.1.5.p.2">According to <a href="#I-D.ietf-anima-bootstrapping-keyinfra" class="xref">[I-D.ietf-anima-bootstrapping-keyinfra]</a> the bootstrapping approach Call-Home has problems and limitations, which (amongst others) the draft itself is trying to address:</p>
<p></p>

<ul>
<li>the pledge requires realtime connectivity to the vendor service</li>
<li>the domain identity is exposed to the vendor service (this is a privacy concern)</li>
<li>the vendor is responsible for making the authorization decisions (this is a liability concern)</li>
</ul>
<p id="rfc.section.1.5.p.4">A Pledge in the context of <a href="#I-D.ietf-anima-bootstrapping-keyinfra" class="xref">[I-D.ietf-anima-bootstrapping-keyinfra]</a> is "the prospective device, which has an identity installed by a third-party (e.g., vendor, manufacturer or integrator)."</p>
<p id="rfc.section.1.5.p.5">A Pledge can be "drop-shipped", which refers to "the physical distribution of equipment containing the 'factory default' configuration to a final destination.  In zero-touch scenarios there is no staging or pre-configuration during drop-ship."</p>
<p id="rfc.section.1.5.p.6">In the scope of Call-Home as a part of YANG Push, either the factory default configuration of a drop-shipped Pledge that is a YANG data store would require to include the "home to Call Home" configuration or it has to be configured locally.</p>
<p><a href="#I-D.ietf-netconf-zerotouch" class="xref">[I-D.ietf-netconf-zerotouch]</a> is intended to provide more flexibility to the Call-Home procedure already - by allowing to stage connection attempts to a locally administered network and if that fails fall back to connecting to a remotely administered network. Alas, <a href="#I-D.ietf-netconf-zerotouch" class="xref">[I-D.ietf-netconf-zerotouch]</a> is either prone to the same limitations as cited above or requires local configuration in order to find the home to Call-Home.</p>
<p id="rfc.section.1.5.p.8">The "Join Registrar" defined by <a href="#I-D.ietf-anima-bootstrapping-keyinfra" class="xref">[I-D.ietf-anima-bootstrapping-keyinfra]</a> mitigates the cited problems and limitation by introducing "a representative of the domain that is configured, perhaps autonomically, to decide whether a new device is allowed to join the domain. The administrator of the domain interfaces with a Join Registrar (and Coordinator) to control this process. Typically a Join Registrar is "inside" its domain."</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#summary-of-the-problem-statement" id="summary-of-the-problem-statement">Summary of the Problem Statement</a>
</h1>
<p id="rfc.section.2.p.1">Currently, the following gaps are identified:</p>
<p></p>

<ul>
<li>no CoAP Subscribe procedure for dynamic YANG subscriptions is standardized that is able to convey a filter expression and potentially other metadata required in the context of a YANG Subscribed Notifications application association. Analogously, new payload types (e.g. a FETCH payload media-type) have to be defined.</li>
<li>no CoAP Call Home feature is standardized to support a popular variant of configured YANG subscriptions.</li>
<li>no general Call Home mechanism is standardized that enables the discovery of "a home to Call Home" or that would be able to deal with "changing homes" in a dynamic but secure manner.</li>
</ul>
<p id="rfc.section.2.p.3">In addition to the identified gaps, the semantics of metadata - if there are any - that have to be conveyed to or from a YANG data store in order to subscribe to a (filtered) YANG module or data node are not identified.</p>
<p id="rfc.section.2.p.4">The problem statement could be summarized as follows:</p>
<p id="rfc.section.2.p.5">"There is no complete solution based on CoAP to enable a freshly unpacked YANG data store ("drop-shipped pledge", e.g. the cliche light bulb) to discover an appropriate home it can than Call-Home to in a secure and trusted manner in order to push (un-)solicited subscribed notifications."</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#potential-approaches-and-solutions" id="potential-approaches-and-solutions">Potential Approaches and Solutions</a>
</h1>
<p id="rfc.section.3.p.1">There are multiple approaches that could lead to viable solutions that address the identified gaps. The following sections illustrate the general solution context and some of the most promising approaches.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#yang-subscription-variants" id="yang-subscription-variants">YANG subscription variants</a>
</h1>
<p id="rfc.section.3.1.p.1">A YANG Push update subscription service both provides support for dynamic subscription (i.e. subscription state created by a client request, allowing for solicited push notifications in the context of an up-time cycle of the server) and configured subscription (i.e. subscription configuration retained on the server, allowing for unsolicited push notifications across up-time cycles of the server).</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#yang-push-via-coap" id="yang-push-via-coap">YANG Push via CoAP</a>
</h1>
<p id="rfc.section.3.2.p.1">The two CoAP operations that enable a subscription mechanism are GET and FETCH (i.e. by supporting the Observe option). Both operations are viable candidates for creating a CoAP-based YANG Push mechanism for CoMI.</p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#dynamic-subscriptions" id="dynamic-subscriptions">Dynamic Subscriptions</a>
</h1>
<p id="rfc.section.3.3.p.1">Using CoAP, the client issuing the initial subscription request creates the subscription state. Examples are the GET or FETCH operation including an Observe option using an Observe parameter of 0 (zero).</p>
<h1 id="rfc.section.3.3.1">
<a href="#rfc.section.3.3.1">3.3.1.</a> <a href="#yang-push-via-get" id="yang-push-via-get">YANG Push via GET</a>
</h1>
<p id="rfc.section.3.3.1.p.1">This usage scenario requires two consecutive operations. It is not possible to transfer a filter expression included in a GET operation. In consequence, a POST operation on a collection resource has to be conducted in order to convey a filter expression to the YANG data store, allowing it to return an URI that contains the data node information filtered in respect to the posted filter expression (encoded in CBOR).</p>
<p id="rfc.section.3.3.1.p.2">This variant allows for multiple clients to observe a specific filtered data node without conducting a POST operation, if the corresponding URI is made known to other clients that did not conduct the POST operation or, for example, is canonically linked to/derivable from a filter expression.</p>
<h1 id="rfc.section.3.3.2">
<a href="#rfc.section.3.3.2">3.3.2.</a> <a href="#yang-push-via-fetch" id="yang-push-via-fetch">YANG Push via FETCH</a>
</h1>
<p id="rfc.section.3.3.2.p.1">This usage scenario requires only one operation. A FETCH operation can include a body that is capable to contain a filter expression and potentially other metadata that might be required to establish a suitable subscription state on the YANG data store.</p>
<p id="rfc.section.3.3.2.p.2">It might be possible that this variant could introduce a slight delay in respect to response time if providing a filtered resource requires a lot of computation time on a constrained device. I.e. the resource cannot be prepared "beforehand".</p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> <a href="#configured-subscriptions" id="configured-subscriptions">Configured Subscriptions</a>
</h1>
<p id="rfc.section.3.4.p.1">Using CoAP, the server retains configuration that creates subscription state when the YANG data store is started. The client has to have or gain knowledge of the CoAP tokens that are included in the responses created in the context of the subscription state create from server configuration.</p>
<h1 id="rfc.section.3.4.1">
<a href="#rfc.section.3.4.1">3.4.1.</a> <a href="#retaining-the-content-of-a-get-operation-as-configuration" id="retaining-the-content-of-a-get-operation-as-configuration">Retaining the Content of a GET Operation as Configuration</a>
</h1>
<p id="rfc.section.3.4.1.p.1">This usage scenario "mimics" the receiving of a subscription request by storing the corresponding information that are relevant for creating a subscription state as configuration on the YANG data store. I.e. the configuration would be including the YANG client IP address and the CoAP token to be used in the responses that convey the subscribed notifications.</p>
<p id="rfc.section.3.4.1.p.2">This variant requires that the client also knows or gains knowledge of the corresponding CoAP token in order to not discard the incoming responses.</p>
<h1 id="rfc.section.3.4.2">
<a href="#rfc.section.3.4.2">3.4.2.</a> <a href="#call-home-via-coap" id="call-home-via-coap">Call Home via CoAP</a>
</h1>
<p id="rfc.section.3.4.2.p.1">This usage scenario defines the Call Home procedure standardized in <a href="#RFC8071" class="xref">[RFC8071]</a> as an additional capability of CoAP. DTLS or TLS state is initiated by the YANG data store and triggers a dynamic subscription procedure of the YANG client using the session initiated by the YANG data store.</p>
<h1 id="rfc.section.3.4.3">
<a href="#rfc.section.3.4.3">3.4.3.</a> <a href="#dynamic-home-discovery" id="dynamic-home-discovery">Dynamic Home Discovery</a>
</h1>
<p id="rfc.section.3.4.3.p.1">This usage scenario is based on the Bootstrapping Remote Secure Key Infrastructures I-D <a href="#I-D.ietf-anima-bootstrapping-keyinfra" class="xref">[I-D.ietf-anima-bootstrapping-keyinfra]</a> and EST over secure CoAP I-D <a href="#I-D.vanderstok-ace-coap-est" class="xref">[I-D.vanderstok-ace-coap-est]</a> and requires the standardization of a general use of Join Registrars in the context of YANG data stores that support YANG Push via static subscriptions.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#iana-considerations" id="iana-considerations">IANA considerations</a>
</h1>
<p id="rfc.section.4.p.1">This document includes no requests to IANA, but solutions drafts incubated via this document might.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a>
</h1>
<p id="rfc.section.5.p.1">This document includes no security considerations, but solution drafts incubated via this document will.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#acknowledgements" id="acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.6.p.1">Carsten Bormann, Klaus Hartke, Michel Veillette</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#change-log" id="change-log">Change Log</a>
</h1>
<p id="rfc.section.7.p.1">First version -00</p>
<h1 id="rfc.references">
<a href="#rfc.references">8.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-anima-bootstrapping-keyinfra">[I-D.ietf-anima-bootstrapping-keyinfra]</b></td>
<td class="top">
<a>Pritikin, M.</a>, <a>Richardson, M.</a>, <a>Behringer, M.</a>, <a>Bjarnason, S.</a> and <a>K. Watsen</a>, "<a href="https://tools.ietf.org/html/draft-ietf-anima-bootstrapping-keyinfra-08">Bootstrapping Remote Secure Key Infrastructures (BRSKI)</a>", Internet-Draft draft-ietf-anima-bootstrapping-keyinfra-08, October 2017.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-core-coap-pubsub">[I-D.ietf-core-coap-pubsub]</b></td>
<td class="top">
<a>Koster, M.</a>, <a>Keranen, A.</a> and <a>J. Jimenez</a>, "<a href="https://tools.ietf.org/html/draft-ietf-core-coap-pubsub-02">Publish-Subscribe Broker for the Constrained Application Protocol (CoAP)</a>", Internet-Draft draft-ietf-core-coap-pubsub-02, July 2017.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-core-coap-tcp-tls">[I-D.ietf-core-coap-tcp-tls]</b></td>
<td class="top">
<a>Bormann, C.</a>, <a>Lemay, S.</a>, <a>Tschofenig, H.</a>, <a>Hartke, K.</a>, <a>Silverajan, B.</a> and <a>B. Raymor</a>, "<a href="https://tools.ietf.org/html/draft-ietf-core-coap-tcp-tls-09">CoAP (Constrained Application Protocol) over TCP, TLS, and WebSockets</a>", Internet-Draft draft-ietf-core-coap-tcp-tls-09, May 2017.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-core-comi">[I-D.ietf-core-comi]</b></td>
<td class="top">
<a>Veillette, M.</a>, <a>Stok, P.</a>, <a>Pelov, A.</a> and <a>A. Bierman</a>, "<a href="https://tools.ietf.org/html/draft-ietf-core-comi-01">CoAP Management Interface</a>", Internet-Draft draft-ietf-core-comi-01, July 2017.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-core-sid">[I-D.ietf-core-sid]</b></td>
<td class="top">
<a>Veillette, M.</a>, <a>Pelov, A.</a>, <a>Turner, R.</a>, <a>Minaburo, A.</a> and <a>A. Somaraju</a>, "<a href="https://tools.ietf.org/html/draft-ietf-core-sid-01">YANG Schema Item iDentifier (SID)</a>", Internet-Draft draft-ietf-core-sid-01, May 2017.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-core-yang-cbor">[I-D.ietf-core-yang-cbor]</b></td>
<td class="top">
<a>Veillette, M.</a>, <a>Pelov, A.</a>, <a>Somaraju, A.</a>, <a>Turner, R.</a> and <a>A. Minaburo</a>, "<a href="https://tools.ietf.org/html/draft-ietf-core-yang-cbor-05">CBOR Encoding of Data Modeled with YANG</a>", Internet-Draft draft-ietf-core-yang-cbor-05, August 2017.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-netconf-subscribed-notifications">[I-D.ietf-netconf-subscribed-notifications]</b></td>
<td class="top">
<a>Voit, E.</a>, <a>Clemm, A.</a>, <a>Prieto, A.</a>, <a>Nilsen-Nygaard, E.</a> and <a>A. Tripathy</a>, "<a href="https://tools.ietf.org/html/draft-ietf-netconf-subscribed-notifications-05">Custom Subscription to Event Notifications</a>", Internet-Draft draft-ietf-netconf-subscribed-notifications-05, October 2017.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-netconf-yang-push">[I-D.ietf-netconf-yang-push]</b></td>
<td class="top">
<a>Clemm, A.</a>, <a>Voit, E.</a>, <a>Prieto, A.</a>, <a>Tripathy, A.</a>, <a>Nilsen-Nygaard, E.</a>, <a>Bierman, A.</a> and <a>B. Lengyel</a>, "<a href="https://tools.ietf.org/html/draft-ietf-netconf-yang-push-10">Subscribing to YANG datastore push updates</a>", Internet-Draft draft-ietf-netconf-yang-push-10, October 2017.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-netconf-zerotouch">[I-D.ietf-netconf-zerotouch]</b></td>
<td class="top">
<a>Watsen, K.</a>, <a>Abrahamsson, M.</a> and <a>I. Farrer</a>, "<a href="https://tools.ietf.org/html/draft-ietf-netconf-zerotouch-18">Zero Touch Provisioning for NETCONF or RESTCONF based Management</a>", Internet-Draft draft-ietf-netconf-zerotouch-18, October 2017.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.vanderstok-ace-coap-est">[I-D.vanderstok-ace-coap-est]</b></td>
<td class="top">
<a>Kumar, S.</a>, <a>Stok, P.</a>, <a>Kampanakis, P.</a>, <a>Furuhed, M.</a> and <a>S. Raza</a>, "<a href="https://tools.ietf.org/html/draft-vanderstok-ace-coap-est-02">EST over secure CoAP (EST-coaps)</a>", Internet-Draft draft-vanderstok-ace-coap-est-02, June 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7049">[RFC7049]</b></td>
<td class="top">
<a>Bormann, C.</a> and <a>P. Hoffman</a>, "<a href="https://tools.ietf.org/html/rfc7049">Concise Binary Object Representation (CBOR)</a>", RFC 7049, DOI 10.17487/RFC7049, October 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7252">[RFC7252]</b></td>
<td class="top">
<a>Shelby, Z.</a>, <a>Hartke, K.</a> and <a>C. Bormann</a>, "<a href="https://tools.ietf.org/html/rfc7252">The Constrained Application Protocol (CoAP)</a>", RFC 7252, DOI 10.17487/RFC7252, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7641">[RFC7641]</b></td>
<td class="top">
<a>Hartke, K.</a>, "<a href="https://tools.ietf.org/html/rfc7641">Observing Resources in the Constrained Application Protocol (CoAP)</a>", RFC 7641, DOI 10.17487/RFC7641, September 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8040">[RFC8040]</b></td>
<td class="top">
<a>Bierman, A.</a>, <a>Bjorklund, M.</a> and <a>K. Watsen</a>, "<a href="https://tools.ietf.org/html/rfc8040">RESTCONF Protocol</a>", RFC 8040, DOI 10.17487/RFC8040, January 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8071">[RFC8071]</b></td>
<td class="top">
<a>Watsen, K.</a>, "<a href="https://tools.ietf.org/html/rfc8071">NETCONF Call Home and RESTCONF Call Home</a>", RFC 8071, DOI 10.17487/RFC8071, February 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8132">[RFC8132]</b></td>
<td class="top">
<a>van der Stok, P.</a>, <a>Bormann, C.</a> and <a>A. Sehgal</a>, "<a href="https://tools.ietf.org/html/rfc8132">PATCH and FETCH Methods for the Constrained Application Protocol (CoAP)</a>", RFC 8132, DOI 10.17487/RFC8132, April 2017.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Henk Birkholz</span> 
	  <span class="n hidden">
		<span class="family-name">Birkholz</span>
	  </span>
	</span>
	<span class="org vcardline">Fraunhofer SIT</span>
	<span class="adr">
	  <span class="vcardline">Rheinstrasse 75</span>

	  <span class="vcardline">
		<span class="locality">Darmstadt</span>,  
		<span class="region"></span>
		<span class="code">64295</span>
	  </span>
	  <span class="country-name vcardline">Germany</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:henk.birkholz@sit.fraunhofer.de">henk.birkholz@sit.fraunhofer.de</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Tianran Zhou</span> 
	  <span class="n hidden">
		<span class="family-name">Zhou</span>
	  </span>
	</span>
	<span class="org vcardline">Huawei</span>
	<span class="adr">
	  <span class="vcardline">156 Beiqing Rd.</span>

	  <span class="vcardline">
		<span class="locality">Beijing</span>,  
		<span class="region">Haidian District</span> 
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">China</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:zhoutianran@huawei.com">zhoutianran@huawei.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Xufeng Liu</span> 
	  <span class="n hidden">
		<span class="family-name">Liu</span>
	  </span>
	</span>
	<span class="org vcardline">Jabil</span>
	<span class="adr">
	  <span class="vcardline">8281 Greensboro Drive, Suite 200</span>

	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region">McLean VA</span> 
		<span class="code">22102</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:Xufeng_Liu@jabil.com">Xufeng_Liu@jabil.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Eric Voit</span> 
	  <span class="n hidden">
		<span class="family-name">Voit</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:evoit@cisco.com">evoit@cisco.com</a></span>

  </address>
</div>

  <div class="github-fork-ribbon-wrapper"><div class="github-fork-ribbon"><a href="https://github.com/henkbirkholz/draft-birkholz-yang-push-coap-problemstatement">Fork me on GitHub</a></div></div>
</body>
</html>
